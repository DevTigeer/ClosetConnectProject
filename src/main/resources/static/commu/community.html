<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Community Boards</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        :root { --gap:14px; }
        body{margin:0;background:#fafafa;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}
        header{position:sticky;top:0;background:#fff;border-bottom:1px solid #eee;padding:12px 16px;display:flex;align-items:center;justify-content:space-between}
        .nav-tabs{background:#fff;border-bottom:2px solid #eee;display:flex;justify-content:center;gap:16px;padding:12px}
        .nav-tab{text-decoration:none;color:#666;font-weight:500;padding:8px 16px;border-radius:8px}
        .nav-tab:hover{background:#f0f0f0}
        .nav-tab.active{color:#667eea;font-weight:600}
        .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:var(--gap);padding:16px}
        .card{background:#fff;border:1px solid #eee;border-radius:12px;padding:14px}
        a{color:#222;text-decoration:none}
        .slug{font-size:12px;color:#888}
    </style>
</head>
<body>
<header>
    <strong>ğŸ  ClosetConnect</strong>
    <nav><a href="/commu/admin-boards.html">ê´€ë¦¬ì</a></nav>
</header>

<div class="nav-tabs">
    <a class="nav-tab" href="/cloth/closet.html">ğŸ‘” ë‚´ ì˜·ì¥</a>
    <a class="nav-tab" href="/market-demo.html">ğŸ›’ ì¤‘ê³ ê±°ë˜</a>
    <a class="nav-tab active" href="/commu/community.html">ğŸ’¬ ì»¤ë®¤ë‹ˆí‹°</a>
    <a class="nav-tab" href="/weather-with-recommendation.html">ğŸŒ¤ï¸ ë‚ ì”¨</a>
    <a class="nav-tab" href="/user/me.html">ğŸ‘¤ ë‚´ ì •ë³´</a>
</div>

<main class="grid" id="boardList"></main>

<script>
    (function(){
        'use strict';
        const token = localStorage.getItem('jwt_token');

        const api = axios.create({
            baseURL: '',
            withCredentials: false,
            headers: token ? { Authorization: token.startsWith('Bearer ') ? token : `Bearer ${token}` } : {}
        });

        async function listPublicBoards(){
            const { data } = await api.get('/api/v1/community/boards');
            return data;
        }

        (async ()=>{
            try {
                const list = await listPublicBoards();
                const wrap = document.querySelector('#boardList');
                if (!list || list.length === 0) {
                    wrap.innerHTML = `<div class="card">í‘œì‹œí•  ë³´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
                    return;
                }
                wrap.innerHTML = list.map(b => `
        <a class="card" href="/commu/board.html?slug=${encodeURIComponent(b.slug)}">
          <div style="font-weight:600">${b.name}</div>
          <div class="slug">${b.slug} Â· ${b.type} Â· ${b.visibility}</div>
        </a>
      `).join('');
            } catch(e){
                console.error(e);
                alert('ë³´ë“œ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨');
            }
        })();
    })();
</script>
</body>
</html>
