<?xml version="1.0" encoding="UTF-8"?>
<svg width="1920" height="1080" viewBox="0 0 1920 1080" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8f9fa"/>
      <stop offset="100%" style="stop-color:#e9ecef"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.1"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#8DABC4"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#28a745"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1920" height="1080" fill="url(#bgGradient)"/>

  <!-- Header -->
  <rect x="0" y="0" width="120" height="120" fill="#8DABC4"/>
  <text x="160" y="50" font-family="Arial, sans-serif" font-size="18" fill="#8DABC4" font-weight="bold">Part 1</text>
  <text x="160" y="90" font-family="Arial, sans-serif" font-size="36" fill="#2c3e50" font-weight="bold">ê¸°ìˆ  ì¦ê±°: ë©”ì‹œì§€ â†’ WebSocket â†’ UI ë°˜ì˜</text>

  <!-- Sequence Diagram Title -->
  <text x="960" y="160" font-family="Arial, sans-serif" font-size="24" fill="#2c3e50" text-anchor="middle" font-weight="bold">ë©”ì‹œì§€ ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨</text>

  <!-- Actors -->
  <!-- Frontend -->
  <rect x="150" y="200" width="140" height="50" rx="8" fill="#F5E0D8" filter="url(#shadow)"/>
  <text x="220" y="232" font-family="Arial, sans-serif" font-size="16" fill="#5a4a42" text-anchor="middle" font-weight="bold">Frontend</text>
  <text x="220" y="265" font-family="Arial, sans-serif" font-size="12" fill="#6c757d" text-anchor="middle">React + SockJS</text>
  <line x1="220" y1="280" x2="220" y2="700" stroke="#F5E0D8" stroke-width="3" stroke-dasharray="5,5"/>

  <!-- Spring Boot -->
  <rect x="450" y="200" width="140" height="50" rx="8" fill="#E8EEF4" filter="url(#shadow)"/>
  <text x="520" y="232" font-family="Arial, sans-serif" font-size="16" fill="#4a5568" text-anchor="middle" font-weight="bold">Spring Boot</text>
  <text x="520" y="265" font-family="Arial, sans-serif" font-size="12" fill="#6c757d" text-anchor="middle">REST + Consumer</text>
  <line x1="520" y1="280" x2="520" y2="700" stroke="#E8EEF4" stroke-width="3" stroke-dasharray="5,5"/>

  <!-- RabbitMQ -->
  <rect x="750" y="200" width="140" height="50" rx="8" fill="#8DABC4" filter="url(#shadow)"/>
  <text x="820" y="232" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-weight="bold">RabbitMQ</text>
  <text x="820" y="265" font-family="Arial, sans-serif" font-size="12" fill="#6c757d" text-anchor="middle">Message Broker</text>
  <line x1="820" y1="280" x2="820" y2="700" stroke="#8DABC4" stroke-width="3" stroke-dasharray="5,5"/>

  <!-- AI Worker -->
  <rect x="1050" y="200" width="140" height="50" rx="8" fill="#F5E0D8" filter="url(#shadow)"/>
  <text x="1120" y="232" font-family="Arial, sans-serif" font-size="16" fill="#5a4a42" text-anchor="middle" font-weight="bold">AI Worker</text>
  <text x="1120" y="265" font-family="Arial, sans-serif" font-size="12" fill="#6c757d" text-anchor="middle">Python + CloudRun</text>
  <line x1="1120" y1="280" x2="1120" y2="700" stroke="#F5E0D8" stroke-width="3" stroke-dasharray="5,5"/>

  <!-- Messages -->
  <!-- 1. Upload request -->
  <line x1="220" y1="320" x2="510" y2="320" stroke="#8DABC4" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="290" y="300" width="150" height="25" rx="4" fill="white"/>
  <text x="365" y="318" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" text-anchor="middle">POST /cloth/upload</text>

  <!-- 2. Publish to MQ -->
  <line x1="520" y1="360" x2="810" y2="360" stroke="#8DABC4" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="580" y="340" width="160" height="25" rx="4" fill="#8DABC4" opacity="0.2"/>
  <text x="660" y="358" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" text-anchor="middle">cloth.processing.queue</text>

  <!-- 3. Consume message -->
  <line x1="820" y1="400" x2="1110" y2="400" stroke="#8DABC4" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="880" y="380" width="150" height="25" rx="4" fill="white"/>
  <text x="955" y="398" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" text-anchor="middle">Consume Message</text>

  <!-- 4. Progress 25% -->
  <line x1="1120" y1="440" x2="830" y2="440" stroke="#28a745" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <rect x="880" y="420" width="160" height="25" rx="4" fill="#d4edda"/>
  <text x="960" y="438" font-family="Arial, sans-serif" font-size="12" fill="#155724" text-anchor="middle">cloth.progress (25%)</text>

  <!-- 5. Spring receives progress -->
  <line x1="820" y1="480" x2="530" y2="480" stroke="#28a745" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <rect x="580" y="460" width="160" height="25" rx="4" fill="#d4edda"/>
  <text x="660" y="478" font-family="Arial, sans-serif" font-size="12" fill="#155724" text-anchor="middle">Consumer receives</text>

  <!-- 6. WebSocket broadcast -->
  <line x1="520" y1="520" x2="230" y2="520" stroke="#28a745" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <rect x="280" y="500" width="180" height="25" rx="4" fill="#d4edda"/>
  <text x="370" y="518" font-family="Arial, sans-serif" font-size="12" fill="#155724" text-anchor="middle">STOMP /queue/progress</text>

  <!-- 7. Progress 50%, 70%, 95% (simplified) -->
  <line x1="1120" y1="560" x2="230" y2="560" stroke="#28a745" stroke-width="2" stroke-dasharray="8,4" marker-end="url(#arrowhead-green)"/>
  <rect x="580" y="540" width="180" height="25" rx="4" fill="#d4edda"/>
  <text x="670" y="558" font-family="Arial, sans-serif" font-size="12" fill="#155724" text-anchor="middle">... 50% â†’ 70% â†’ 95% ...</text>

  <!-- 8. Final result -->
  <line x1="1120" y1="600" x2="830" y2="600" stroke="#8DABC4" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="880" y="580" width="160" height="25" rx="4" fill="#8DABC4" opacity="0.2"/>
  <text x="960" y="598" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" text-anchor="middle">cloth.result.queue</text>

  <!-- 9. Update DB -->
  <line x1="820" y1="640" x2="530" y2="640" stroke="#8DABC4" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="580" y="620" width="160" height="25" rx="4" fill="white"/>
  <text x="660" y="638" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" text-anchor="middle">DB Update + WS 100%</text>

  <!-- 10. Complete notification -->
  <line x1="520" y1="680" x2="230" y2="680" stroke="#8DABC4" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="280" y="660" width="180" height="25" rx="4" fill="white"/>
  <text x="370" y="678" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" text-anchor="middle">READY_FOR_REVIEW</text>

  <!-- Right side - Queue details -->
  <rect x="1300" y="200" width="550" height="500" rx="15" fill="white" filter="url(#shadow)"/>
  <text x="1575" y="240" font-family="Arial, sans-serif" font-size="20" fill="#2c3e50" text-anchor="middle" font-weight="bold">RabbitMQ í êµ¬ì¡°</text>

  <!-- Exchange -->
  <rect x="1450" y="270" width="250" height="45" rx="8" fill="#8DABC4"/>
  <text x="1575" y="300" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-weight="bold">cloth.exchange (Direct)</text>

  <!-- Queue 1 -->
  <rect x="1330" y="350" width="200" height="80" rx="8" fill="#F5E0D8"/>
  <text x="1430" y="380" font-family="Arial, sans-serif" font-size="14" fill="#5a4a42" text-anchor="middle" font-weight="bold">cloth.processing.queue</text>
  <text x="1430" y="405" font-family="Arial, sans-serif" font-size="12" fill="#6c757d" text-anchor="middle">Spring â†’ Worker</text>
  <text x="1430" y="420" font-family="Arial, sans-serif" font-size="11" fill="#6c757d" text-anchor="middle">clothId, imageBytes, userId</text>

  <!-- Queue 2 -->
  <rect x="1550" y="350" width="200" height="80" rx="8" fill="#d4edda"/>
  <text x="1650" y="380" font-family="Arial, sans-serif" font-size="14" fill="#155724" text-anchor="middle" font-weight="bold">cloth.progress.queue</text>
  <text x="1650" y="405" font-family="Arial, sans-serif" font-size="12" fill="#6c757d" text-anchor="middle">Worker â†’ Spring</text>
  <text x="1650" y="420" font-family="Arial, sans-serif" font-size="11" fill="#6c757d" text-anchor="middle">ì§„í–‰ë¥  0~100%</text>

  <!-- Queue 3 -->
  <rect x="1440" y="460" width="200" height="80" rx="8" fill="#E8EEF4"/>
  <text x="1540" y="490" font-family="Arial, sans-serif" font-size="14" fill="#4a5568" text-anchor="middle" font-weight="bold">cloth.result.queue</text>
  <text x="1540" y="515" font-family="Arial, sans-serif" font-size="12" fill="#6c757d" text-anchor="middle">Worker â†’ Spring</text>
  <text x="1540" y="530" font-family="Arial, sans-serif" font-size="11" fill="#6c757d" text-anchor="middle">ìµœì¢… ì´ë¯¸ì§€ URLs</text>

  <!-- Arrows between exchange and queues -->
  <line x1="1500" y1="315" x2="1430" y2="350" stroke="#8DABC4" stroke-width="2"/>
  <line x1="1575" y1="315" x2="1540" y2="460" stroke="#8DABC4" stroke-width="2"/>
  <line x1="1650" y1="315" x2="1650" y2="350" stroke="#8DABC4" stroke-width="2"/>

  <!-- WebSocket config -->
  <rect x="1330" y="570" width="490" height="100" rx="8" fill="#f8f9fa" stroke="#8DABC4" stroke-width="1"/>
  <text x="1575" y="600" font-family="Arial, sans-serif" font-size="14" fill="#8DABC4" text-anchor="middle" font-weight="bold">WebSocket ì„¤ì •</text>
  <text x="1360" y="630" font-family="monospace" font-size="12" fill="#495057">Endpoint: /ws (STOMP + SockJS)</text>
  <text x="1360" y="655" font-family="monospace" font-size="12" fill="#495057">Subscribe: /queue/cloth/progress/{userId}</text>

  <!-- Impact statement -->
  <rect x="100" y="740" width="1720" height="80" rx="15" fill="#8DABC4" opacity="0.1"/>
  <rect x="100" y="740" width="8" height="80" fill="#8DABC4"/>
  <text x="140" y="790" font-family="Arial, sans-serif" font-size="28" fill="#2c3e50" font-style="italic">"3ê°œ í, 2ê°œ ì»¨ìŠˆë¨¸, 1ê°œ WebSocketìœ¼ë¡œ ì‹¤ì‹œê°„ UX êµ¬í˜„"</text>

  <!-- Screenshot hints -->
  <rect x="100" y="860" width="560" height="120" rx="10" fill="white" filter="url(#shadow)"/>
  <text x="130" y="895" font-family="Arial, sans-serif" font-size="14" fill="#8DABC4" font-weight="bold">ğŸ“¸ í•„ìš” ìŠ¤í¬ë¦°ìƒ·</text>
  <text x="130" y="920" font-family="Arial, sans-serif" font-size="12" fill="#495057">â€¢ RabbitMQ ê´€ë¦¬ ì½˜ì†” (3ê°œ í ëª©ë¡)</text>
  <text x="130" y="940" font-family="Arial, sans-serif" font-size="12" fill="#495057">â€¢ ë¸Œë¼ìš°ì € DevTools WebSocket ë©”ì‹œì§€</text>
  <text x="130" y="960" font-family="Arial, sans-serif" font-size="12" fill="#495057">â€¢ Spring ë¡œê·¸ (ë©”ì‹œì§€ ë°œí–‰/ìˆ˜ì‹ )</text>

  <!-- Speaker notes -->
  <rect x="700" y="860" width="1120" height="120" rx="10" fill="white" filter="url(#shadow)"/>
  <text x="730" y="895" font-family="Arial, sans-serif" font-size="14" fill="#8DABC4" font-weight="bold">ğŸ’¬ ë°œí‘œ ëŒ€ë³¸</text>
  <text x="730" y="920" font-family="Arial, sans-serif" font-size="12" fill="#495057">ê¸°ìˆ ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì—…ë¡œë“œ APIê°€ í˜¸ì¶œë˜ë©´ Springì´ íŒŒì¼ì„ ì €ì¥í•˜ê³ ,</text>
  <text x="730" y="940" font-family="Arial, sans-serif" font-size="12" fill="#495057">Cloth ì—”í‹°í‹°ë¥¼ PROCESSING ìƒíƒœë¡œ ìƒì„±í•©ë‹ˆë‹¤. ë™ì‹œì— RabbitMQì˜ cloth.processing íë¡œ ë©”ì‹œì§€ë¥¼ ë°œí–‰í•©ë‹ˆë‹¤.</text>
  <text x="730" y="960" font-family="Arial, sans-serif" font-size="12" fill="#495057">Python Workerê°€ ì´ ë©”ì‹œì§€ë¥¼ ë°›ì•„ AI íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•˜ë©´ì„œ, ê° ë‹¨ê³„ë§ˆë‹¤ progress íë¡œ ì§„í–‰ë¥ ì„ ë³´ëƒ…ë‹ˆë‹¤.</text>
</svg>
