# ë„ë©”ì¸ ì„¤ê³„ ë¬¸ì„œ

**ì‘ì„±ì¼**: 2024-12-30
**ì‘ì„±ì**: Development Team
**ë²„ì „**: 1.0

---

## ğŸ“Œ ìš”ì•½

ClosetConnectì˜ í•µì‹¬ ë„ë©”ì¸ì„ DDD(Domain-Driven Design) ê´€ì ì—ì„œ ì •ì˜í•˜ê³ , ì—”í‹°í‹° ê´€ê³„ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì„ ëª…í™•íˆ í•©ë‹ˆë‹¤.

---

## 1. í•µì‹¬ ë„ë©”ì¸ ì •ì˜

### 1.1 Bounded Context

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ClosetConnect System            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Closet     â”‚  Community   â”‚  Market   â”‚
â”‚   Context    â”‚   Context    â”‚  Context  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Closet Context (ì˜·ì¥ ê´€ë¦¬)
- **ì±…ì„**: ì‚¬ìš©ìì˜ ì˜·ì„ ë””ì§€í„¸í™”í•˜ê³  ê´€ë¦¬
- **ì£¼ìš” ì—”í‹°í‹°**: Cloth, Ootd
- **ì£¼ìš” ê¸°ëŠ¥**:
  - ì˜· ë“±ë¡ ë° AI ì²˜ë¦¬
  - AI ì½”ë”” ì¡°í•©
  - OOTD ì €ì¥ ë° ê´€ë¦¬

### Community Context (ì»¤ë®¤ë‹ˆí‹°)
- **ì±…ì„**: ì‚¬ìš©ì ê°„ ì†Œí†µ ë° ì •ë³´ ê³µìœ 
- **ì£¼ìš” ì—”í‹°í‹°**: CommunityBoard, Post, Comment
- **ì£¼ìš” ê¸°ëŠ¥**:
  - ê²Œì‹œê¸€ ì‘ì„±/ì¡°íšŒ
  - ëŒ“ê¸€ ë‹¬ê¸°
  - ì¢‹ì•„ìš”

### Market Context (ì¤‘ê³ ê±°ë˜)
- **ì±…ì„**: ì¤‘ê³  ì˜ë¥˜ ê±°ë˜
- **ì£¼ìš” ì—”í‹°í‹°**: MarketProduct, MarketOrder, MarketChatRoom
- **ì£¼ìš” ê¸°ëŠ¥**:
  - ìƒí’ˆ ë“±ë¡/ì¡°íšŒ
  - ì±„íŒ…
  - ì£¼ë¬¸/ê²°ì œ

---

## 2. ì—”í‹°í‹° ë° ê°’ ê°ì²´

### 2.1 Closet Context

#### Cloth (ì—”í‹°í‹°)
```java
@Entity
public class Cloth extends BaseTimeEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    private Users user;           // ì†Œìœ ì

    private String name;          // ì˜· ì´ë¦„

    @Enumerated(EnumType.STRING)
    private Category category;    // TOP, BOTTOM, SHOES, ACC

    private String imageUrl;      // ì›ë³¸ ì´ë¯¸ì§€
    private String segmentedImageUrl;   // ì„¸ê·¸ë¨¼íŠ¸ ì´ë¯¸ì§€
    private String inpaintedImageUrl;   // ì¸í˜ì¸íŠ¸ ì´ë¯¸ì§€

    @Enumerated(EnumType.STRING)
    private ProcessingStatus status;  // PROCESSING, READY_FOR_REVIEW, CONFIRMED
}
```

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
- í•œ ì‚¬ìš©ìëŠ” ì—¬ëŸ¬ ì˜·ì„ ê°€ì§ˆ ìˆ˜ ìˆìŒ (1:N)
- ì˜·ì€ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì ¸ì•¼ í•¨
- statusê°€ CONFIRMEDì¸ ì˜·ë§Œ ì¡°í•©í•˜ê¸°ì— ì‚¬ìš© ê°€ëŠ¥

#### Ootd (ì—”í‹°í‹°)
```java
@Entity
public class Ootd extends BaseTimeEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    private Users user;

    private String imageUrl;      // AI ìƒì„± ì½”ë”” ì´ë¯¸ì§€
    private String description;   // ì„¤ëª… (ì„ íƒ)
}
```

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
- OOTDëŠ” AI ì½”ë”” ê²°ê³¼ë¬¼ì„ ì €ì¥í•œ ê²ƒ
- ì‚¬ìš©ìëŠ” ë¬´ì œí•œ OOTD ì €ì¥ ê°€ëŠ¥
- ì‚­ì œëŠ” ë³¸ì¸ë§Œ ê°€ëŠ¥

### 2.2 Community Context

#### CommunityBoard (ì—”í‹°í‹°)
```java
@Entity
public class CommunityBoard extends BaseTimeEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;    // ê²Œì‹œíŒ ì´ë¦„
    private String slug;    // URLìš© slug

    @Enumerated(EnumType.STRING)
    private Visibility visibility;  // PUBLIC, PRIVATE, ADMIN_ONLY
}
```

#### Post (ì—”í‹°í‹°)
```java
@Entity
public class Post extends BaseTimeEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    private CommunityBoard board;

    @ManyToOne(fetch = FetchType.LAZY)
    private Users author;

    private String title;
    private String content;

    private Integer viewCount;
    private Boolean pinned;
}
```

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
- ê²Œì‹œê¸€ì€ í•˜ë‚˜ì˜ ê²Œì‹œíŒì— ì†í•¨
- ì‘ì„±ìë§Œ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
- ê´€ë¦¬ìëŠ” ëª¨ë“  ê²Œì‹œê¸€ ê´€ë¦¬ ê°€ëŠ¥
- Pinned ê²Œì‹œê¸€ì€ ìµœìƒë‹¨ ê³ ì •

#### Comment (ì—”í‹°í‹°)
```java
@Entity
public class Comment extends BaseTimeEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    private Post post;

    @ManyToOne(fetch = FetchType.LAZY)
    private Users author;

    private String content;
}
```

### 2.3 Market Context

#### MarketProduct (ì—”í‹°í‹°)
```java
@Entity
public class MarketProduct extends BaseTimeEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    private Users seller;

    private String title;
    private String description;
    private BigDecimal price;

    @Enumerated(EnumType.STRING)
    private ProductStatus status;  // SALE, RESERVED, SOLD_OUT

    @ElementCollection
    private List<String> imageUrls;
}
```

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
- íŒë§¤ìë§Œ ìƒí’ˆ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
- RESERVED ìƒíƒœì—ì„œ 30ë¶„ ë‚´ ê²°ì œ ì•ˆ í•˜ë©´ SALEë¡œ ë³µêµ¬
- SOLD_OUT ìƒí’ˆì€ ìˆ˜ì • ë¶ˆê°€

#### MarketOrder (ì—”í‹°í‹°)
```java
@Entity
public class MarketOrder extends BaseTimeEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    private MarketProduct product;

    @ManyToOne(fetch = FetchType.LAZY)
    private Users buyer;

    private BigDecimal amount;

    @Enumerated(EnumType.STRING)
    private OrderStatus status;  // PENDING, PAID, SHIPPED, DELIVERED, CANCELLED

    private String paymentKey;
    private String trackingNumber;
}
```

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
- ì£¼ë¬¸ ìƒì„± ì‹œ PENDING ìƒíƒœ
- ê²°ì œ ì™„ë£Œ ì‹œ PAID
- íŒë§¤ìë§Œ SHIPPED ì²˜ë¦¬ ê°€ëŠ¥
- êµ¬ë§¤ìë§Œ DELIVERED ì²˜ë¦¬ ê°€ëŠ¥

---

## 3. Aggregate ê¸°ì¤€

### Closet Aggregate
- **Root**: Users
- **í¬í•¨**: Cloth, Ootd
- **ê²½ê³„**: ì‚¬ìš©ìì™€ ê·¸ê°€ ì†Œìœ í•œ ì˜·, OOTD

### Community Aggregate
- **Root**: CommunityBoard
- **í¬í•¨**: Post, Comment
- **ê²½ê³„**: ê²Œì‹œíŒê³¼ ê·¸ ì•ˆì˜ ê²Œì‹œê¸€, ëŒ“ê¸€

### Market Aggregate
- **Root**: MarketProduct
- **í¬í•¨**: MarketOrder
- **ê²½ê³„**: ìƒí’ˆê³¼ ê·¸ì— ëŒ€í•œ ì£¼ë¬¸

---

## 4. íŠ¸ëœì­ì…˜ ê²½ê³„

### 4.1 Cloth ë“±ë¡
```
íŠ¸ëœì­ì…˜ 1: Cloth ì—”í‹°í‹° ìƒì„± ë° ì €ì¥
íŠ¸ëœì­ì…˜ 2: AI ì²˜ë¦¬ ì™„ë£Œ í›„ ìƒíƒœ ì—…ë°ì´íŠ¸ (ë¹„ë™ê¸°)
íŠ¸ëœì­ì…˜ 3: ì‚¬ìš©ì ì´ë¯¸ì§€ ì„ íƒ ë° í™•ì •
```

**ì´ìœ **: AI ì²˜ë¦¬ëŠ” ì˜¤ë˜ ê±¸ë¦¬ë¯€ë¡œ ë³„ë„ íŠ¸ëœì­ì…˜

### 4.2 ì¤‘ê³ ê±°ë˜ ê²°ì œ
```
íŠ¸ëœì­ì…˜ 1: MarketOrder ìƒì„± (PENDING)
íŠ¸ëœì­ì…˜ 2: TossPayments ê²°ì œ ìŠ¹ì¸
íŠ¸ëœì­ì…˜ 3: MarketOrder ìƒíƒœ ë³€ê²½ (PAID) + MarketProduct ìƒíƒœ ë³€ê²½ (RESERVED)
```

**ì´ìœ **: ê²°ì œ ìŠ¹ì¸ê³¼ ìƒíƒœ ë³€ê²½ì€ ì›ìì ìœ¼ë¡œ ì²˜ë¦¬

### 4.3 ê²Œì‹œê¸€ ì‘ì„±
```
íŠ¸ëœì­ì…˜ 1: Post ì—”í‹°í‹° ìƒì„± ë° ì €ì¥
íŠ¸ëœì­ì…˜ 2: ì²¨ë¶€íŒŒì¼ ì—…ë¡œë“œ (ë³„ë„)
```

**ì´ìœ **: íŒŒì¼ ì—…ë¡œë“œëŠ” ì„ íƒì‚¬í•­

---

## 5. ë„ë©”ì¸ ì´ë²¤íŠ¸

### ClothUploadedEvent
- **ë°œìƒ ì‹œì **: ì˜· ì´ë¯¸ì§€ ì—…ë¡œë“œ ì™„ë£Œ
- **ë¦¬ìŠ¤ë„ˆ**: ClothUploadedEventListener
- **ë™ì‘**: RabbitMQë¡œ AI ì²˜ë¦¬ ë©”ì‹œì§€ ë°œí–‰

### OrderPaidEvent (í–¥í›„)
- **ë°œìƒ ì‹œì **: ì£¼ë¬¸ ê²°ì œ ì™„ë£Œ
- **ë¦¬ìŠ¤ë„ˆ**: NotificationService
- **ë™ì‘**: íŒë§¤ìì—ê²Œ ì•Œë¦¼

---

## 6. ê°’ ê°ì²´ (Value Object)

### Category (Enum)
```java
public enum Category {
    TOP,      // ìƒì˜
    BOTTOM,   // í•˜ì˜
    SHOES,    // ì‹ ë°œ
    ACC       // ì•¡ì„¸ì„œë¦¬
}
```

### ProcessingStatus (Enum)
```java
public enum ProcessingStatus {
    PROCESSING,         // AI ì²˜ë¦¬ ì¤‘
    READY_FOR_REVIEW,  // ì²˜ë¦¬ ì™„ë£Œ, ì´ë¯¸ì§€ ì„ íƒ ëŒ€ê¸°
    CONFIRMED          // ìµœì¢… í™•ì •
}
```

### OrderStatus (Enum)
```java
public enum OrderStatus {
    PENDING,    // ê²°ì œ ëŒ€ê¸°
    PAID,       // ê²°ì œ ì™„ë£Œ
    SHIPPED,    // ë°œì†¡ ì™„ë£Œ
    DELIVERED,  // êµ¬ë§¤ í™•ì •
    CANCELLED   // ì·¨ì†Œ
}
```

---

## 7. ë„ë©”ì¸ ì„œë¹„ìŠ¤

### OutfitService
- **ì±…ì„**: AI ì½”ë”” ìƒì„±
- **ì´ìœ **: Cloth ì—”í‹°í‹°ì˜ ì±…ì„ì´ ì•„ë‹˜ (ì—¬ëŸ¬ Clothì˜ ì¡°í•©)

### PaymentService
- **ì±…ì„**: TossPayments API ì—°ë™
- **ì´ìœ **: ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ì€ ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬

---

## ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë²„ì „ | ì‘ì„±ì | ë³€ê²½ ë‚´ìš© |
|------|------|--------|-----------|
| 2024-12-30 | 1.0 | Development Team | ì´ˆê¸° ë¬¸ì„œ ì‘ì„± |
